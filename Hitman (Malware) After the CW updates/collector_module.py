# collector_module.py
import os
import shutil

TARGET_EXTS = {'.txt', '.pdf', '.docx', '.jpg', '.png'}
COLLECTED_FOLDER = "collected_files"

# copy_mode=True to copy (retain originals), False to move (delete originals)
def collect_target_files(copy_mode: bool = True):
    """
    Scan Documents for TARGET_EXTS and copy or move each matching file into COLLECTED_FOLDER.
    If copy_mode=True, files are copied and originals retained.
    If copy_mode=False, files are moved and originals deleted.
    """
    docs = os.path.join(os.path.expanduser("~"), "Documents")
    os.makedirs(COLLECTED_FOLDER, exist_ok=True)

    for root, _, files in os.walk(docs):
        for f in files:
            if os.path.splitext(f)[1].lower() in TARGET_EXTS:
                src = os.path.join(root, f)
                dst = os.path.join(COLLECTED_FOLDER, f)
                try:
                    if copy_mode:
                        shutil.copy2(src, dst)
                        print(f"✅ Copied: {src} -> {dst}")
                    else:
                        shutil.move(src, dst)
                        print(f"✅ Moved: {src} -> {dst}")
                except PermissionError:
                    print(f"⚠️ Skipped (in use): {src}")